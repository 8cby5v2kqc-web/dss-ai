<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Rich Picture (редактируемая версия)</title>
    <style>
        body { background: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; font-family: 'Segoe UI', sans-serif; }
        .container { background: white; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); padding: 20px; }
        canvas { display: block; border: 1px solid #ccc; border-radius: 8px; background: white; }
    </style>
</head>
<body>
<div class="container">
    <canvas id="richCanvas" width="1200" height="800"></canvas>
</div>

<script>
    const canvas = document.getElementById('richCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // --- Вспомогательные функции (можно не трогать) ---
    function drawRectWithText(x, y, w, h, title, lines, color = '#e3f2fd') {
        ctx.fillStyle = color;
        ctx.fillRect(x, y, w, h);
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.strokeRect(x, y, w, h);
        ctx.font = 'bold 16px "Segoe UI", sans-serif';
        ctx.fillStyle = '#000';
        ctx.textAlign = 'center';
        ctx.fillText(title, x + w/2, y + 25);
        ctx.font = '14px "Segoe UI", sans-serif';
        ctx.fillStyle = '#222';
        for (let i = 0; i < lines.length; i++) {
            ctx.fillText(lines[i], x + w/2, y + 50 + i * 20);
        }
    }

    function drawCloud(x, y, w, h, lines, color = '#fff9c4') {
        ctx.fillStyle = color;
        ctx.strokeStyle = '#888';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.ellipse(x, y, w/2, h/2, 0, 0, Math.PI*2);
        ctx.fill();
        ctx.stroke();
        ctx.font = '14px "Segoe UI", sans-serif';
        ctx.fillStyle = '#000';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        let startY = y - (lines.length-1) * 10;
        for (let i = 0; i < lines.length; i++) {
            ctx.fillText(lines[i], x, startY + i * 20);
        }
    }

    function drawArrow(x1, y1, x2, y2, label = '', color = '#555', dashed = false) {
        ctx.beginPath();
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.setLineDash(dashed ? [5, 5] : []);
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
        ctx.setLineDash([]);
        const angle = Math.atan2(y2 - y1, x2 - x1);
        const arrowSize = 12;
        const dx = arrowSize * 0.7 * Math.cos(angle - 0.2);
        const dy = arrowSize * 0.7 * Math.sin(angle - 0.2);
        const dx2 = arrowSize * 0.7 * Math.cos(angle + 0.2);
        const dy2 = arrowSize * 0.7 * Math.sin(angle + 0.2);
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(x2, y2);
        ctx.lineTo(x2 - dx, y2 - dy);
        ctx.lineTo(x2 - dx2, y2 - dy2);
        ctx.closePath();
        ctx.fill();
        if (label) {
            ctx.font = 'italic 14px "Segoe UI", sans-serif';
            ctx.fillStyle = '#333';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'bottom';
            const midX = (x1 + x2) / 2;
            const midY = (y1 + y2) / 2 - 10;
            ctx.fillText(label, midX, midY);
        }
    }

    // --- Рисуем элементы ---
    // Клиент (слева)
    drawRectWithText(50, 200, 180, 160, 'Клиент', [
        'тревога/депрессия',
        'сомнения, стигма',
        'ведёт дневник',
        '(бумага/телефон)'
    ], '#bbdefb');

    // Психолог (справа)
    drawRectWithText(970, 200, 180, 160, 'Психолог', [
        'сессии, опросники',
        '(Beck, GAD-7)',
        'ручная обработка',
        'бумажные карты'
    ], '#c8e6c9');

    // Платформа (центр)
    drawRectWithText(450, 220, 300, 220, 'Защищенная платформа', [
        '• Эл. опросники (автоподсчёт)',
        '• Безопасный дневник',
        '• Панель психолога',
        '• Шифрование и доступ'
    ], '#ffe0b2');

    // Облака проблем
    drawCloud(1060, 100, 200, 60, ['Ручная обработка →', 'ошибки до 15%'], '#ffccbc');
    drawCloud(600, 60, 240, 60, ['Нет структурированного', 'наблюдения между сессиями'], '#ffe0b2');
    drawCloud(140, 100, 200, 60, ['Риск утечки', 'конфиденциальных данных'], '#ffab91');

    // Стрелка "Сессии" (теперь проходит ниже, чтобы не мешать тексту)
    drawArrow(230, 330, 970, 330, 'Сессии', '#2c3e50');

    // Стрелка от клиента к платформе
    drawArrow(230, 280, 450, 300, 'Заполняет скрининги,\nведёт дневник', '#2e7d32');

    // Стрелка от психолога к платформе
    drawArrow(970, 280, 750, 320, 'Получает отчёты,\nотслеживает динамику', '#2e7d32');

    // Можно добавлять свои стрелки или фигуры здесь
</script>
</body>
</html>
